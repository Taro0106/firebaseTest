import{_ as C,r as o,c as v,b as t,G as $,f as _,H as s,I as x,p as c,J as f,F as D,h as M,t as N,i as k,K as I,j as O,k as S,n as p,L as A,d as L}from"./index-DR2h0RFb.js";import{S as r}from"./sweetalert2.esm.all-BQxta0Da.js";const Q={class:"container"},T={class:"main-content"},h={class:"image-section"},P={key:0,class:"upload-placeholder"},R={key:1,class:"loading-overlay"},j={key:2,class:"hover-overlay"},z={class:"info-section"},E={class:"form-group"},G={class:"form-group"},H={class:"radio-group"},J={class:"form-group"},K={class:"radio-group"},q={class:"form-group rating-row"},W={class:"star-group"},X=["onClick","onMouseover"],Y={class:"comment-section"},Z=["disabled"],ee="dn6r2yt4y",te="Favory",le={__name:"addFavory",setup(U){const w=o(!1),n=o(""),i=o(""),a=o(""),m=o(""),y=o(5),g=o(""),u=o(!1);o([]);const F=async d=>{const e=d.target.files[0];if(!e)return;u.value=!0;const l=new FormData;l.append("file",e),l.append("upload_preset",te);try{const V=await(await fetch(`https://api.cloudinary.com/v1_1/${ee}/image/upload`,{method:"POST",body:l})).json();V.secure_url&&(i.value=V.secure_url)}catch{alert("圖片傳送失敗 Q_Q")}finally{u.value=!1}},B=async()=>{if(!n.value)return r.fire({icon:"warning",title:"哎呀！",text:"請輸入名稱喔！",confirmButtonColor:"#6366f1"});if(!i.value)return r.fire({icon:"warning",title:"圖片在哪呢？",text:"請挑選一張喜歡的圖片作為封面吧！",confirmButtonColor:"#6366f1"});if(!k.currentUser)return r.fire({icon:"error",title:"權限不足",text:"登入後才能收藏喔！",confirmButtonColor:"#6366f1"});r.fire({title:"儲存中...",allowOutsideClick:!1,didOpen:()=>{r.showLoading()}});try{await I(O(S,"myFavoryList"),{name:n.value,image:i.value,category:a.value,status:m.value,rating:y.value,comment:g.value,uid:k.currentUser.uid,createdAt:new Date}),r.fire({icon:"success",title:"成功加入收藏！",text:`《${n.value}》已經入庫囉！`,timer:2e3,showConfirmButton:!1,timerProgressBar:!0}),n.value="",i.value="",g.value="",a.value="",y.value=5,w.value=!1}catch(d){console.error(d),r.fire({icon:"error",title:"Oops...",text:"發生了一些錯誤，請稍後再試 Q_Q"})}};return(d,e)=>(p(),v("div",Q,[t("div",T,[t("div",h,[t("label",{class:"upload-box",style:$({backgroundImage:`url(${i.value})`})},[t("input",{type:"file",onChange:F,hidden:"",accept:"image/*"},null,32),!i.value&&!u.value?(p(),v("div",P,[...e[9]||(e[9]=[t("span",null,"+ 點擊上傳封面",-1)])])):_("",!0),u.value?(p(),v("div",R,"上傳中...")):_("",!0),i.value?(p(),v("div",j,[...e[10]||(e[10]=[t("span",null,"更換圖片",-1)])])):_("",!0)],4)]),t("div",z,[t("div",E,[e[11]||(e[11]=t("label",{class:"label-text"},"作品名稱",-1)),s(t("input",{style:{"max-width":"90%"},"onUpdate:modelValue":e[0]||(e[0]=l=>n.value=l),type:"text",placeholder:"請輸入名稱...",class:"input-text"},null,512),[[x,n.value]])]),t("div",G,[e[14]||(e[14]=t("label",{class:"label-text"},"狀態",-1)),t("div",H,[t("label",null,[s(t("input",{type:"radio","onUpdate:modelValue":e[1]||(e[1]=l=>m.value=l),value:"完結",hidden:""},null,512),[[f,m.value]]),e[12]||(e[12]=c(" 完結",-1))]),t("label",null,[s(t("input",{type:"radio","onUpdate:modelValue":e[2]||(e[2]=l=>m.value=l),value:"未完結",hidden:""},null,512),[[f,m.value]]),e[13]||(e[13]=c(" 未完結",-1))])])]),t("div",J,[e[18]||(e[18]=t("label",{class:"label-text"},"分類",-1)),t("div",K,[t("label",null,[s(t("input",{type:"radio","onUpdate:modelValue":e[3]||(e[3]=l=>a.value=l),value:"漫畫",hidden:""},null,512),[[f,a.value]]),e[15]||(e[15]=c(" 漫畫",-1))]),t("label",null,[s(t("input",{type:"radio","onUpdate:modelValue":e[4]||(e[4]=l=>a.value=l),value:"動漫",hidden:""},null,512),[[f,a.value]]),e[16]||(e[16]=c(" 動漫",-1))]),t("label",null,[s(t("input",{type:"radio","onUpdate:modelValue":e[5]||(e[5]=l=>a.value=l),value:"電影",hidden:""},null,512),[[f,a.value]]),e[17]||(e[17]=c(" 電影",-1))]),s(t("input",{type:"text","onUpdate:modelValue":e[6]||(e[6]=l=>a.value=l),placeholder:"其他",class:"input-inline"},null,512),[[x,a.value]])])]),t("div",q,[e[19]||(e[19]=t("label",null,[t("label",{class:"label-text"},"評分")],-1)),t("div",W,[(p(),v(D,null,M(5,l=>t("span",{key:l,class:A(["star-item",{active:l<=y.value}]),onClick:b=>y.value=l,onMouseover:b=>d.hoverRating=l,onMouseleave:e[7]||(e[7]=b=>d.hoverRating=0)}," ★ ",42,X)),64))])])])]),t("div",Y,[e[20]||(e[20]=t("label",{class:"label-text"},"評論",-1)),s(t("textarea",{"onUpdate:modelValue":e[8]||(e[8]=l=>g.value=l),placeholder:"寫點什麼吧..."},null,512),[[x,g.value]]),t("button",{onClick:B,disabled:u.value,class:"submit-btn"},N(u.value?"上傳中...":"確認收藏"),9,Z)])]))}},ae=C(le,[["__scopeId","data-v-fb8d92e6"]]),oe={class:"page"},se={__name:"AddFavoryView",setup(U){return(w,n)=>(p(),v("div",oe,[L(ae)]))}},re=C(se,[["__scopeId","data-v-08ad2f3f"]]);export{re as default};
