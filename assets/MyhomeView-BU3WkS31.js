import{_ as B,r as m,o as V,a as F,c,b as s,d as r,e as S,f as h,t as _,w as n,g as $,F as k,h as C,T as q,s as R,i as w,u as T,q as A,j as I,k as D,l as E,m as O,n as l,p as v,v as x,x as Q,y as j,R as z,z as P}from"./index-DR2h0RFb.js";import{S as y}from"./sweetalert2.esm.all-BQxta0Da.js";const G={class:"navbar-container"},H={class:"sidebar-desktop"},J={class:"user-profile"},K=["src"],W={class:"user-name"},X={class:"menu-sections"},Y={class:"category-section"},Z={class:"category-list"},U={class:"bottom-nav-mobile"},ss=["src"],as={class:"mobile-category-grid"},ts={__name:"Navbar",setup(M){const b=T(),i=m({name:"未登入",avatar:"https://cdn-icons-png.flaticon.com/512/3682/3682281.png"}),f=m(!1);V(()=>{F(w,e=>{e?(i.value={name:e.displayName||"神秘收藏家",avatar:e.photoURL||"https://cdn-icons-png.flaticon.com/512/3682/3682281.png"},N(e.uid),f.value=!0):(i.value={name:"未登入",avatar:"https://cdn-icons-png.flaticon.com/512/3682/3682281.png"},f.value=!1,u.value=[])})});const L=async()=>{if((await y.fire({title:"要準備離開了嗎？",text:"登出後就需要重新登入才能看到收藏喔！",icon:"question",showCancelButton:!0,confirmButtonColor:"#ff799f",cancelButtonColor:"#aaa",confirmButtonText:"是的，登出",cancelButtonText:"再留一下",reverseButtons:!0,background:"#fffafb"})).isConfirmed)try{await R(w),y.fire({icon:"success",title:"已安全登出",text:"期待下次見到你 ✨",timer:1500,showConfirmButton:!1,timerProgressBar:!0}),b.push("/")}catch(a){console.error("登出失敗",a),y.fire({icon:"error",title:"登出時發生錯誤",text:"請稍後再試一次 Q_Q"})}},u=m([]),N=async e=>{try{const a=A(I(D,"myFavoryList"),E("uid","==",e)),o=await O(a),t=[];o.forEach(g=>{g.data().category&&t.push(g.data().category)}),u.value=[...new Set(t)]}catch(a){console.error("抓取分類失敗",a)}},d=m(!1),p=()=>{d.value=!d.value};return(e,a)=>{const o=$("router-link");return l(),c("nav",G,[s("aside",H,[a[5]||(a[5]=s("div",{class:"brand"},[s("img",{src:S,alt:"Favory Logo",class:"brand-logo"})],-1)),s("div",J,[s("img",{src:i.value.avatar,alt:"avatar",class:"avatar"},null,8,K),s("span",W,_(i.value.name),1),f.value?(l(),c("button",{key:0,onClick:L,class:"logout-btn"},"登出")):h("",!0)]),a[6]||(a[6]=s("div",{class:"divider"},null,-1)),s("div",X,[r(o,{to:"/Myhome/List",class:"nav-link"},{default:n(()=>[...a[2]||(a[2]=[s("span",{class:"icon"},[s("i",{class:"fa-regular fa-heart"})],-1),v(" 全部收藏 ",-1)])]),_:1}),r(o,{to:"/Myhome/AddFavory",class:"nav-link"},{default:n(()=>[...a[3]||(a[3]=[s("span",{class:"icon"},[s("i",{class:"fa-solid fa-plus"})],-1),v(" 新增 ",-1)])]),_:1}),s("div",Y,[a[4]||(a[4]=s("p",{class:"section-label"},"我的分類",-1)),s("div",Z,[(l(!0),c(k,null,C(u.value,t=>(l(),x(o,{key:t,to:`/Myhome/category/${t}`,class:"category-item"},{default:n(()=>[v(" # "+_(t),1)]),_:2},1032,["to"]))),128))])])])]),s("div",U,[r(o,{to:"/Myhome/List",class:"mobile-nav-item"},{default:n(()=>[...a[7]||(a[7]=[s("span",{class:"icon"},[s("i",{class:"fa-regular fa-heart"})],-1),s("span",{class:"label"},"全部",-1)])]),_:1}),r(o,{to:"/Myhome/AddFavory",class:"mobile-nav-item"},{default:n(()=>[...a[8]||(a[8]=[s("span",{class:"icon"},[s("i",{class:"fa-solid fa-plus"})],-1),s("span",{class:"label"},"新增",-1)])]),_:1}),s("button",{onClick:p,class:"mobile-nav-item btn-reset"},[...a[9]||(a[9]=[s("span",{class:"icon"},[s("i",{class:"fa-solid fa-hashtag"})],-1),s("span",{class:"label"},"分類",-1)])]),r(o,{to:"/profile",class:"mobile-nav-item"},{default:n(()=>[s("img",{src:i.value.avatar,class:"mini-avatar"},null,8,ss),a[10]||(a[10]=s("span",{class:"label"},"帳號",-1))]),_:1})]),r(q,{name:"fade"},{default:n(()=>[d.value?(l(),c("div",{key:0,class:"mobile-modal-overlay",onClick:p},[s("div",{class:"mobile-modal-content",onClick:a[1]||(a[1]=Q(()=>{},["stop"]))},[a[11]||(a[11]=s("h3",null,"選擇分類",-1)),s("div",as,[(l(!0),c(k,null,C(u.value,t=>(l(),x(o,{key:t,to:`/Myhome/category/${t}`,class:"m-cat-item",onClick:a[0]||(a[0]=g=>d.value=!1)},{default:n(()=>[v(_(t),1)]),_:2},1032,["to"]))),128))]),s("button",{class:"close-btn",onClick:p},"關閉")])])):h("",!0)]),_:1})])}}},os=B(ts,[["__scopeId","data-v-1b85f8b9"]]),es={class:"myhome-container"},ns={class:"main-container"},ls={__name:"MyhomeView",setup(M){return P(),(b,i)=>(l(),c("div",es,[r(os),s("main",ns,[r(j(z))])]))}},cs=B(ls,[["__scopeId","data-v-e9340b1b"]]);export{cs as default};
