import{_ as U,r as o,c as v,b as t,E as M,f as _,G as s,H as x,p as c,I as f,F as D,h as N,t as h,i as C,J as I,j as O,k as S,u as A,n as p,K as L,d as Q}from"./index-DsnLLBDL.js";import{S as i}from"./sweetalert2.esm.all-BQxta0Da.js";const R={class:"container"},T={class:"main-content"},P={class:"image-section"},j={key:0,class:"upload-placeholder"},z={key:1,class:"loading-overlay"},E={key:2,class:"hover-overlay"},G={class:"info-section"},H={class:"form-group"},J={class:"form-group"},K={class:"radio-group"},q={class:"form-group"},W={class:"radio-group"},X={class:"form-group rating-row"},Y={class:"star-group"},Z=["onClick","onMouseover"],ee={class:"comment-section"},te=["disabled"],le="dn6r2yt4y",ae="Favory",oe={__name:"addFavory",setup(F){const w=A(),V=o(!1),r=o(""),n=o(""),a=o(""),m=o(""),y=o(0),g=o(""),u=o(!1);o([]);const B=async d=>{const e=d.target.files[0];if(!e)return;u.value=!0;const l=new FormData;l.append("file",e),l.append("upload_preset",ae);try{const k=await(await fetch(`https://api.cloudinary.com/v1_1/${le}/image/upload`,{method:"POST",body:l})).json();k.secure_url&&(n.value=k.secure_url)}catch{alert("圖片傳送失敗 Q_Q")}finally{u.value=!1}},$=async()=>{if(!r.value)return i.fire({icon:"warning",title:"哎呀！",text:"請輸入名稱喔！",confirmButtonColor:"#6366f1"});if(!n.value)return i.fire({icon:"warning",title:"圖片在哪呢？",text:"請挑選一張喜歡的圖片作為封面吧！",confirmButtonColor:"#6366f1"});if(!C.currentUser)return i.fire({icon:"error",title:"權限不足",text:"登入後才能收藏喔！",confirmButtonColor:"#6366f1"});i.fire({title:"儲存中...",allowOutsideClick:!1,didOpen:()=>{i.showLoading()}});try{await I(O(S,"myFavoryList"),{name:r.value,image:n.value,category:a.value,status:m.value,rating:y.value,comment:g.value,uid:C.currentUser.uid,createdAt:new Date}),i.fire({icon:"success",title:"成功加入收藏！",text:`《${r.value}》已經入庫囉！`,timer:2e3,showConfirmButton:!1,timerProgressBar:!0}),r.value="",n.value="",g.value="",a.value="",y.value=0,V.value=!1,w.push("/Myhome/List")}catch(d){console.error(d),i.fire({icon:"error",title:"Oops...",text:"發生了一些錯誤，請稍後再試 Q_Q"})}};return(d,e)=>(p(),v("div",R,[t("div",T,[t("div",P,[t("label",{class:"upload-box",style:M({backgroundImage:`url(${n.value})`})},[t("input",{type:"file",onChange:B,hidden:"",accept:"image/*"},null,32),!n.value&&!u.value?(p(),v("div",j,[...e[9]||(e[9]=[t("span",null,"+ 點擊上傳封面",-1)])])):_("",!0),u.value?(p(),v("div",z,"上傳中...")):_("",!0),n.value?(p(),v("div",E,[...e[10]||(e[10]=[t("span",null,"更換圖片",-1)])])):_("",!0)],4)]),t("div",G,[t("div",H,[e[11]||(e[11]=t("label",{class:"label-text"},"作品名稱",-1)),s(t("input",{style:{"max-width":"90%"},"onUpdate:modelValue":e[0]||(e[0]=l=>r.value=l),type:"text",placeholder:"請輸入名稱...",class:"input-text"},null,512),[[x,r.value]])]),t("div",J,[e[14]||(e[14]=t("label",{class:"label-text"},"狀態",-1)),t("div",K,[t("label",null,[s(t("input",{type:"radio","onUpdate:modelValue":e[1]||(e[1]=l=>m.value=l),value:"完結",hidden:""},null,512),[[f,m.value]]),e[12]||(e[12]=c(" 完結",-1))]),t("label",null,[s(t("input",{type:"radio","onUpdate:modelValue":e[2]||(e[2]=l=>m.value=l),value:"未完結",hidden:""},null,512),[[f,m.value]]),e[13]||(e[13]=c(" 未完結",-1))])])]),t("div",q,[e[18]||(e[18]=t("label",{class:"label-text"},"分類",-1)),t("div",W,[t("label",null,[s(t("input",{type:"radio","onUpdate:modelValue":e[3]||(e[3]=l=>a.value=l),value:"漫畫",hidden:""},null,512),[[f,a.value]]),e[15]||(e[15]=c(" 漫畫",-1))]),t("label",null,[s(t("input",{type:"radio","onUpdate:modelValue":e[4]||(e[4]=l=>a.value=l),value:"動漫",hidden:""},null,512),[[f,a.value]]),e[16]||(e[16]=c(" 動漫",-1))]),t("label",null,[s(t("input",{type:"radio","onUpdate:modelValue":e[5]||(e[5]=l=>a.value=l),value:"電影",hidden:""},null,512),[[f,a.value]]),e[17]||(e[17]=c(" 電影",-1))]),s(t("input",{type:"text","onUpdate:modelValue":e[6]||(e[6]=l=>a.value=l),placeholder:"其他",class:"input-inline"},null,512),[[x,a.value]])])]),t("div",X,[e[19]||(e[19]=t("label",null,[t("label",{class:"label-text"},"評分")],-1)),t("div",Y,[(p(),v(D,null,N(5,l=>t("span",{key:l,class:L(["star-item",{active:l<=y.value}]),onClick:b=>y.value=l,onMouseover:b=>d.hoverRating=l,onMouseleave:e[7]||(e[7]=b=>d.hoverRating=0)}," ★ ",42,Z)),64))])])])]),t("div",ee,[e[20]||(e[20]=t("label",{class:"label-text"},"評論",-1)),s(t("textarea",{"onUpdate:modelValue":e[8]||(e[8]=l=>g.value=l),placeholder:"寫點什麼吧..."},null,512),[[x,g.value]]),t("button",{onClick:$,disabled:u.value,class:"submit-btn"},h(u.value?"上傳中...":"確認收藏"),9,te)])]))}},se=U(oe,[["__scopeId","data-v-fca9741f"]]),ne={class:"page"},ie={__name:"AddFavoryView",setup(F){return(w,V)=>(p(),v("div",ne,[Q(se)]))}},de=U(ie,[["__scopeId","data-v-08ad2f3f"]]);export{de as default};
