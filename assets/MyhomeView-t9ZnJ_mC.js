import{_ as L,r as f,o as V,a as $,b as F,c as u,d as a,e as n,w as e,f as T,g as h,t as _,F as k,h as C,T as q,s as A,i as w,u as D,j as I,k as B,l as E,q as H,m as O,n as j,p as z,v as i,x as v,y as M,z as G,A as J,R as K,B as P}from"./index-D_iK1aoA.js";import{S as x}from"./sweetalert2.esm.all-BQxta0Da.js";const Q={class:"navbar-container"},U={class:"sidebar-desktop"},W={class:"brand"},X={class:"user-profile"},Y=["src"],Z={class:"user-name"},ss={class:"menu-sections"},as={class:"category-section"},ts={class:"category-list"},os={class:"bottom-nav-mobile"},es=["src"],ns={class:"mobile-category-grid"},ls={__name:"Navbar",setup(N){const b=D(),r=f({name:"載入中...",avatar:"https://cdn-icons-png.flaticon.com/512/3682/3682281.png"}),p=f(!1),d=f([]),m=f(!1);let c=null;V(()=>{$(w,async l=>{if(l){p.value=!0;try{const s=I(B,"users",l.uid),t=await E(s);if(t.exists()){const o=t.data();r.value={name:o.displayName||"神秘收藏家",avatar:o.photoURL||"https://cdn-icons-png.flaticon.com/512/3682/3682281.png"}}else r.value={name:l.displayName||"神秘收藏家",avatar:l.photoURL||"https://cdn-icons-png.flaticon.com/512/3682/3682281.png"}}catch(s){console.error("抓取使用者資料失敗:",s)}R(l.uid)}else r.value={name:"未登入",avatar:"https://cdn-icons-png.flaticon.com/512/3682/3682281.png"},p.value=!1,d.value=[],c&&(c(),c=null)})}),F(()=>{c&&c()});const R=l=>{try{const s=H(O(B,"myFavoryList"),j("uid","==",l));c=z(s,t=>{const o=[];t.forEach(y=>{y.data().category&&o.push(y.data().category)}),d.value=[...new Set(o)],console.log("分類已即時更新:",d.value)},t=>{console.error("監聽分類失敗:",t)})}catch(s){console.error("啟動分類監聽失敗",s)}},S=async()=>{if((await x.fire({title:"要準備離開了嗎？",text:"登出後就需要重新登入才能看到收藏喔！",icon:"question",showCancelButton:!0,confirmButtonColor:"#ff799f",cancelButtonColor:"#aaa",confirmButtonText:"是的，登出",cancelButtonText:"再留一下",reverseButtons:!0,background:"#fffafb"})).isConfirmed)try{await A(w),x.fire({icon:"success",title:"已安全登出",timer:1500,showConfirmButton:!1}),b.push("/")}catch(s){console.error("登出失敗",s)}},g=()=>{m.value=!m.value};return(l,s)=>{const t=T("router-link");return i(),u("nav",Q,[a("aside",U,[a("div",W,[n(t,{to:"/Home",class:"logo-link"},{default:e(()=>[...s[2]||(s[2]=[a("i",{class:"fa-solid fa-house"},null,-1)])]),_:1})]),a("div",X,[a("img",{src:r.value.avatar,alt:"avatar",class:"avatar"},null,8,Y),a("span",Z,_(r.value.name),1),p.value?(i(),u("button",{key:0,onClick:S,class:"logout-btn"},"登出")):h("",!0)]),s[6]||(s[6]=a("div",{class:"divider"},null,-1)),a("div",ss,[n(t,{to:"/Myhome/List",class:"nav-link"},{default:e(()=>[...s[3]||(s[3]=[a("span",{class:"icon"},[a("i",{class:"fa-regular fa-heart"})],-1),v(" 全部收藏 ",-1)])]),_:1}),n(t,{to:"/Myhome/AddFavory",class:"nav-link"},{default:e(()=>[...s[4]||(s[4]=[a("span",{class:"icon"},[a("i",{class:"fa-solid fa-plus"})],-1),v(" 新增 ",-1)])]),_:1}),a("div",as,[s[5]||(s[5]=a("p",{class:"section-label"},"我的分類",-1)),a("div",ts,[(i(!0),u(k,null,C(d.value,o=>(i(),M(t,{key:o,to:`/Myhome/category/${o}`,class:"category-item"},{default:e(()=>[v(" # "+_(o),1)]),_:2},1032,["to"]))),128))])])])]),a("div",os,[n(t,{to:"/Myhome/List",class:"mobile-nav-item"},{default:e(()=>[...s[7]||(s[7]=[a("span",{class:"icon"},[a("i",{class:"fa-regular fa-heart"})],-1),a("span",{class:"label"},"全部",-1)])]),_:1}),n(t,{to:"/Myhome/AddFavory",class:"mobile-nav-item"},{default:e(()=>[...s[8]||(s[8]=[a("span",{class:"icon"},[a("i",{class:"fa-solid fa-plus"})],-1),a("span",{class:"label"},"新增",-1)])]),_:1}),n(t,{to:"/Home",class:"mobile-nav-item"},{default:e(()=>[...s[9]||(s[9]=[a("span",{class:"icon"},[a("i",{class:"fa-solid fa-house"})],-1),a("span",{class:"label"},"首頁",-1)])]),_:1}),a("button",{onClick:g,class:"mobile-nav-item btn-reset"},[...s[10]||(s[10]=[a("span",{class:"icon"},[a("i",{class:"fa-solid fa-hashtag"})],-1),a("span",{class:"label"},"分類",-1)])]),n(t,{to:"/profile",class:"mobile-nav-item"},{default:e(()=>[a("img",{src:r.value.avatar,class:"mini-avatar"},null,8,es),s[11]||(s[11]=a("span",{class:"label"},"帳號",-1))]),_:1})]),n(q,{name:"fade"},{default:e(()=>[m.value?(i(),u("div",{key:0,class:"mobile-modal-overlay",onClick:g},[a("div",{class:"mobile-modal-content",onClick:s[1]||(s[1]=G(()=>{},["stop"]))},[s[12]||(s[12]=a("h3",null,"選擇分類",-1)),a("div",ns,[(i(!0),u(k,null,C(d.value,o=>(i(),M(t,{key:o,to:`/Myhome/category/${o}`,class:"m-cat-item",onClick:s[0]||(s[0]=y=>m.value=!1)},{default:e(()=>[v(_(o),1)]),_:2},1032,["to"]))),128))]),a("button",{class:"close-btn",onClick:g},"關閉")])])):h("",!0)]),_:1})])}}},is=L(ls,[["__scopeId","data-v-50a35080"]]),rs={class:"myhome-container"},cs={class:"main-container"},us={__name:"MyhomeView",setup(N){return P(),(b,r)=>(i(),u("div",rs,[n(is),a("main",cs,[n(J(K))])]))}},fs=L(us,[["__scopeId","data-v-9ea004ab"]]);export{fs as default};
